!function e(t,r,n){function s(o,a){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){var r=t[o][1][e];return s(r?r:e)},u,u.exports,e,t,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e,t){"use strict";function r(e){this.listenerMap=[{},{}],e&&this.root(e),this.handle=r.prototype.handle.bind(this)}function n(e,t){return e.toLowerCase()===t.tagName.toLowerCase()}function s(e,t){return this.rootElement===window?t===document:this.rootElement===t}function i(e,t){return e===t.id}t.exports=r,r.prototype.root=function(e){var t,r=this.listenerMap;if(this.rootElement){for(t in r[1])r[1].hasOwnProperty(t)&&this.rootElement.removeEventListener(t,this.handle,!0);for(t in r[0])r[0].hasOwnProperty(t)&&this.rootElement.removeEventListener(t,this.handle,!1)}if(!e||!e.addEventListener)return this.rootElement&&delete this.rootElement,this;this.rootElement=e;for(t in r[1])r[1].hasOwnProperty(t)&&this.rootElement.addEventListener(t,this.handle,!0);for(t in r[0])r[0].hasOwnProperty(t)&&this.rootElement.addEventListener(t,this.handle,!1);return this},r.prototype.captureForType=function(e){return-1!==["blur","error","focus","load","resize","scroll"].indexOf(e)},r.prototype.on=function(e,t,r,a){var l,u,c,p;if(!e)throw new TypeError("Invalid event type: "+e);if("function"==typeof t&&(a=r,r=t,t=null),void 0===a&&(a=this.captureForType(e)),"function"!=typeof r)throw new TypeError("Handler must be a type of Function");return l=this.rootElement,u=this.listenerMap[a?1:0],u[e]||(l&&l.addEventListener(e,this.handle,a),u[e]=[]),t?/^[a-z]+$/i.test(t)?(p=t,c=n):/^#[a-z0-9\-_]+$/i.test(t)?(p=t.slice(1),c=i):(p=t,c=o):(p=null,c=s.bind(this)),u[e].push({selector:t,handler:r,matcher:c,matcherParam:p}),this},r.prototype.off=function(e,t,r,n){var s,i,o,a,l;if("function"==typeof t&&(n=r,r=t,t=null),void 0===n)return this.off(e,t,r,!0),this.off(e,t,r,!1),this;if(o=this.listenerMap[n?1:0],!e){for(l in o)o.hasOwnProperty(l)&&this.off(l,t,r);return this}if(a=o[e],!a||!a.length)return this;for(s=a.length-1;s>=0;s--)i=a[s],t&&t!==i.selector||r&&r!==i.handler||a.splice(s,1);return a.length||(delete o[e],this.rootElement&&this.rootElement.removeEventListener(e,this.handle,n)),this},r.prototype.handle=function(e){var t,r,n,s,i,o,a,l=e.type,u=[],c="ftLabsDelegateIgnore";if(e[c]!==!0){switch(a=e.target,3===a.nodeType&&(a=a.parentNode),n=this.rootElement,s=e.eventPhase||(e.target!==e.currentTarget?3:2)){case 1:u=this.listenerMap[1][l];break;case 2:this.listenerMap[0]&&this.listenerMap[0][l]&&(u=u.concat(this.listenerMap[0][l])),this.listenerMap[1]&&this.listenerMap[1][l]&&(u=u.concat(this.listenerMap[1][l]));break;case 3:u=this.listenerMap[0][l]}for(r=u.length;a&&r;){for(t=0;r>t&&(i=u[t],i);t++)if(i.matcher.call(a,i.matcherParam,a)&&(o=this.fire(e,a,i)),o===!1)return e[c]=!0,void e.preventDefault();if(a===n)break;r=u.length,a=a.parentElement}}},r.prototype.fire=function(e,t,r){return r.handler.call(t,e,t)};var o=function(e){if(e){var t=e.prototype;return t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector}}(Element);r.prototype.destroy=function(){this.off(),this.root()}},{}],2:[function(e,t){var r=e("../vendor/reqwest.min"),n="http://ft-next-api-user-prefs.herokuapp.com/user/",s=function(e,t){var r=document.createEvent("Event");r.initEvent(e,!0,!0),t&&(r.detail=t),top.document.dispatchEvent(r)},i=function(e,t){if(!e)throw new Error("You must supply a key /^[a-z]+$/");this.key=e,this.localStorageKey="ft.next.user."+e,t&&(this.apiURL=n+e,this.userId=t),this.val=this.getOrCreate(),this.fetch()};i.prototype.get=function(e){e=e||this.localStorageKey;var t=localStorage.getItem(e);return t?JSON.parse(t):!1},i.prototype.getOrCreate=function(e){e=e||this.localStorageKey;var t=this.get(e);if(t)return t;var r=[];return localStorage.setItem(e,JSON.stringify(r)),r},i.prototype.fetch=function(){var e=this;this.userId&&r({url:this.apiURL,type:"json",method:"get",headers:{"X-FT-UID":this.userId},crossOrigin:!0}).then(function(t){t&&(e.val=t,e.save(e.val),e.processPending("add"),e.processPending("remove"),e.processPending("clear"))}).always(function(){s(e.key+":load",e),s(e.key+":update",e)})},i.prototype.save=function(e,t){t=t||this.localStorageKey,e&&e.length?localStorage.setItem(t,JSON.stringify(e)):localStorage.removeItem(t)},i.prototype.addPending=function(e,t){var r=this.getOrCreate(this.localStorageKey+"."+t);r.push(e),"add"===t&&localStorage.removeItem(this.localStorageKey+".clear"),this.save(r,this.localStorageKey+"."+t)},i.prototype.processPending=function(e){var t=this,r=this.get(this.localStorageKey+"."+e);r&&r.length&&("clear"===e?r[r.length-1]===!0&&(t.clear(),r=null):r.forEach(function(n,s){r.splice(s,1),t[e](n)}),this.save(r,this.localStorageKey+"."+e))},i.prototype.add=function(e){var t=this;this.val=this.getOrCreate(),this.exists(e.uuidv3)||(this.val.push(e),this.save(this.val),s(t.key+":update",t),this.apiURL&&r({url:this.apiURL,method:"put",type:"json",contentType:"application/json",data:JSON.stringify(e),headers:{"X-FT-UID":this.userId},crossOrigin:!0}).fail(function(){t.addPending(e,"add")}))},i.prototype.remove=function(e){var t=this;this.val=this.getOrCreate(),this.val=this.val.filter(function(t){return t.uuidv3!==e.uuidv3}),this.save(this.val),s(t.key+":update",t),this.apiURL&&r({url:this.apiURL+"/"+encodeURI(decodeURI(e.uuidv3)),type:"json",method:"delete",headers:{"X-FT-UID":this.userId},crossOrigin:!0}).fail(function(){t.addPending(e,"remove")})},i.prototype.exists=function(e){return this.val=this.getOrCreate(),this.val.some(function(t){return t.uuidv3===e})},i.prototype.clear=function(){var e=this,t=localStorage.removeItem(this.localStorageKey);return this.val=[],s(e.key+":update",e),this.apiURL&&r({url:this.apiURL,type:"json",method:"delete",headers:{"X-FT-UID":this.userId},crossOrigin:!0}).fail(function(){e.addPending(!0,"clear")}),t},t.exports=i},{"../vendor/reqwest.min":6}],3:[function(e,t){function r(e){this.userPreferenceList=e,setInterval(this.poll.bind(this),3e4),this.notifications={},this.currentStream=a(),this.currentStream&&this.clear(this.currentStream),this.poll()}function n(e,t){var r=e.getElementsByClassName("js-notify-badge")[0];r||(r=document.createElement("span"),r.className="notify-badge js-notify-badge",e.appendChild(r)),t>0?(r.removeAttribute("aria-hidden"),r.textContent=t):r.setAttribute("aria-hidden","")}var s=e("../vendor/reqwest.min"),i="http://ft-next-api-user-prefs.herokuapp.com/user/notifications/",o=function(e,t){var r=document.createEvent("Event");r.initEvent(e,!0,!0),t&&(r.detail=t),top.document.dispatchEvent(r)},a=function(){var e=/^\/[a-f0-9]+-(.*)/.test(location.pathname);return e?!1:localStorage.getItem("ft.stream.context.url")};r.prototype.poll=function(){var e=this,t=[];this.userPreferenceList.list.get().forEach(function(r){return"stream"!==r.resourceType||r.uuidv3===e.currentStream?!1:void t.push(s({url:i+r.uuidv3,type:"json",method:"get",headers:{"X-FT-UID":e.userPreferenceList.userId},crossOrigin:!0}).then(function(t){t&&t.length?e.notifications[r.uuidv3]=t:delete e.notifications[r.uuidv3],e.render()}))}),Promise.all(t).then(function(){e.notifications&&o("notifications:new",e.notifications)})},r.prototype.render=function(){for(var e in this.notifications)link=this.userPreferenceList.container.querySelector('[href="/search?q='+e+'"]'),link&&n(link,this.notifications[e].length)},r.prototype.clear=function(e){e?(this.notifications[e]=[],s({url:i+e,type:"json",method:"delete",headers:{"X-FT-UID":this.userPreferenceList.userId},crossOrigin:!0})):"undefined"==typeof e&&(this.notifications={}),this.render()},t.exports=r},{"../vendor/reqwest.min":6}],4:[function(e,t){var r=e("./NotificationPoller"),n=e("./Me"),s=function(e){return[].slice.call(document.querySelectorAll(e))},i=function(){var e="; "+document.cookie,t=e.split("; FT_U="),r=t.pop().split(";").shift();return r?r.match(/_EID=(\d+)_PID/)[1]:void 0},o=function(e,t){this.userId=i(),this.key=e.getAttribute("data-user-preference-list"),this.container=e,this.notify=t.notify};o.prototype.init=function(){var e=this;this.userId||this.render(),document.addEventListener(this.key+":add",function(t){e.add(t.detail)}),document.addEventListener(this.key+":remove",function(t){e.remove(t.detail)}),document.addEventListener(this.key+":clear",this.clear.bind(this)),document.addEventListener(this.key+":update",this.render.bind(this)),s('[data-list-source="'+this.key+'"] .clear__button').map(function(t){t.addEventListener("click",e.clear.bind(e))}),this.list=new n(this.key,this.userId),this.notify===!0&&(this.notifier=new r(this))},o.prototype.render=function(){var e="",t=this.list?this.list.getOrCreate().reverse():[],r=t.map(function(t){return e="stream"===t.resourceType?"/search?q="+t.uuidv3:"/"+t.uuidv3,'<li class="item-type--'+t.resourceType+'"><a href="'+e+'">'+t.displayText+"</a></li>"}).join("");this.container&&(this.container.innerHTML=r),this.notifier&&this.notifier.render()},o.prototype.add=function(e){this.list.add(e)},o.prototype.remove=function(e){this.list.remove(e)},o.prototype.clear=function(){this.list.clear()},o.init=function(e,t){var r,n,s,i,a={};if(e=e||document.body,e.querySelectorAll)for(r=e.querySelectorAll("[data-user-preference-list]"),n=0,s=r.length;s>n;n++)r[n].hasAttribute("data-o-author-alerts--js")||(i=new o(r[n],t||{}),i.init(t),a[r[n].getAttribute("data-user-preference-list")]=i);return a},t.exports=o},{"./Me":2,"./NotificationPoller":3}],5:[function(e,t){var r=e("./lib/UserPreferenceList");t.exports=r},{"./lib/UserPreferenceList":4}],6:[function(require,module,exports){!function(e,t,r){"undefined"!=typeof module&&module.exports?module.exports=r():"function"==typeof define&&define.amd?define(r):t[e]=r()}("reqwest",this,function(){function succeed(e){return httpsRe.test(window.location.protocol)?twoHundo.test(e.status):!!e.response}function handleReadyState(e,t,r){return function(){return e._aborted?r(e.request):void(e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,succeed(e.request)?t(e.request):r(e.request)))}}function setHeaders(e,t){var r,n=t.headers||{};n.Accept=n.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var s="function"==typeof FormData&&t.data instanceof FormData;!t.crossOrigin&&!n[requestedWith]&&(n[requestedWith]=defaultHeaders.requestedWith),!n[contentType]&&!s&&(n[contentType]=t.contentType||defaultHeaders.contentType);for(r in n)n.hasOwnProperty(r)&&"setRequestHeader"in e&&e.setRequestHeader(r,n[r])}function setCredentials(e,t){"undefined"!=typeof t.withCredentials&&"undefined"!=typeof e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,r,n){var s=uniqid++,i=e.jsonpCallback||"callback",o=e.jsonpCallbackName||reqwest.getcallbackPrefix(s),a=new RegExp("((^|\\?|&)"+i+")=([^&]+)"),l=n.match(a),u=doc.createElement("script"),c=0,p=-1!==navigator.userAgent.indexOf("MSIE 10.0");return l?"?"===l[3]?n=n.replace(a,"$1="+o):o=l[3]:n=urlappend(n,i+"="+o),win[o]=generalCallback,u.type="text/javascript",u.src=n,u.async=!0,"undefined"!=typeof u.onreadystatechange&&!p&&(u.htmlFor=u.id="_reqwest_"+s),u.onload=u.onreadystatechange=function(){return u[readyState]&&"complete"!==u[readyState]&&"loaded"!==u[readyState]||c?!1:(u.onload=u.onreadystatechange=null,u.onclick&&u.onclick(),t(lastValue),lastValue=void 0,head.removeChild(u),c=1,void 0)},head.appendChild(u),{abort:function(){u.onload=u.onreadystatechange=null,r({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(u),c=1}}}function getRequest(e,t){var r,n=this.o,s=(n.method||"GET").toUpperCase(),i="string"==typeof n?n:n.url,o=n.processData!==!1&&n.data&&"string"!=typeof n.data?reqwest.toQueryString(n.data):n.data||null,a=!1;return("jsonp"==n.type||"GET"==s)&&o&&(i=urlappend(i,o),o=null),"jsonp"==n.type?handleJsonp(n,e,t,i):(r=n.xhr&&n.xhr(n)||xhr(n),r.open(s,i,n.async===!1?!1:!0),setHeaders(r,n),setCredentials(r,n),win[xDomainRequest]&&r instanceof win[xDomainRequest]?(r.onload=e,r.onerror=t,r.onprogress=function(){},a=!0):r.onreadystatechange=handleReadyState(this,e,t),n.before&&n.before(r),a?setTimeout(function(){r.send(o)},200):r.send(o),r)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){return e.match("json")?"json":e.match("javascript")?"js":e.match("text")?"html":e.match("xml")?"xml":void 0}function init(o,fn){function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function error(e,t,r){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=r,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,r);complete(e)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var r,n,s,i,o=e.name,a=e.tagName.toLowerCase(),l=function(e){e&&!e.disabled&&t(o,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))};if(!e.disabled&&o)switch(a){case"input":/reset|button|image|file/i.test(e.type)||(r=/checkbox/i.test(e.type),n=/radio/i.test(e.type),s=e.value,(!r&&!n||e.checked)&&t(o,normalize(r&&""===s?"on":s)));break;case"textarea":t(o,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())l(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(i=0;e.length&&i<e.length;i++)e.options[i].selected&&l(e.options[i])}}function eachFormElement(){var e,t,r=this,n=function(e,t){var n,s,i;for(n=0;n<t.length;n++)for(i=e[byTag](t[n]),s=0;s<i.length;s++)serial(i[s],r)};for(t=0;t<arguments.length;t++)e=arguments[t],/input|select|textarea/i.test(e.tagName)&&serial(e,r),n(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,r){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(r)):e[t]=r},arguments),e}function buildParams(e,t,r,n){var s,i,o,a=/\[\]$/;if(isArray(t))for(i=0;t&&i<t.length;i++)o=t[i],r||a.test(e)?n(e,o):buildParams(e+"["+("object"==typeof o?i:"")+"]",o,r,n);else if(t&&"[object Object]"===t.toString())for(s in t)buildParams(e+"["+s+"]",t[s],r,n);else n(e,t)}var win=window,doc=document,httpsRe=/^http/,twoHundo=/^(20\d|1223)$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(e.crossOrigin===!0){var t=win[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},"catch":function(e){return this.fail(e)}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,r){e.push({name:t,value:r})},arguments),e},reqwest.serialize=function(){if(0===arguments.length)return"";var e,t,r=Array.prototype.slice.call(arguments,0);return e=r.pop(),e&&e.nodeType&&r.push(e)&&(e=null),e&&(e=e.type),t="map"==e?serializeHash:"array"==e?reqwest.serializeArray:serializeQueryString,t.apply(null,r)},reqwest.toQueryString=function(e,t){var r,n,s=t||!1,i=[],o=encodeURIComponent,a=function(e,t){t="function"==typeof t?t():null==t?"":t,i[i.length]=o(e)+"="+o(t)};if(isArray(e))for(n=0;e&&n<e.length;n++)a(e[n].name,e[n].value);else for(r in e)e.hasOwnProperty(r)&&buildParams(r,e[r],s,a);return i.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest})},{}],7:[function(require,module,exports){!function(e,t,r){"undefined"!=typeof module&&module.exports?module.exports=r():"function"==typeof define&&define.amd?define(r):t[e]=r()}("reqwest",this,function(){function succeed(e){var t=protocolRe.exec(e.url);return t=t&&t[1]||window.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,r){return function(){return e._aborted?r(e.request):void(e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):r(e.request)))}}function setHeaders(e,t){var r,n=t.headers||{};n.Accept=n.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var s="function"==typeof FormData&&t.data instanceof FormData;t.crossOrigin||n[requestedWith]||(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||s||(n[contentType]=t.contentType||defaultHeaders.contentType);for(r in n)n.hasOwnProperty(r)&&"setRequestHeader"in e&&e.setRequestHeader(r,n[r])}function setCredentials(e,t){"undefined"!=typeof t.withCredentials&&"undefined"!=typeof e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,r,n){var s=uniqid++,i=e.jsonpCallback||"callback",o=e.jsonpCallbackName||reqwest.getcallbackPrefix(s),a=new RegExp("((^|\\?|&)"+i+")=([^&]+)"),l=n.match(a),u=doc.createElement("script"),c=0,p=-1!==navigator.userAgent.indexOf("MSIE 10.0");return l?"?"===l[3]?n=n.replace(a,"$1="+o):o=l[3]:n=urlappend(n,i+"="+o),win[o]=generalCallback,u.type="text/javascript",u.src=n,u.async=!0,"undefined"==typeof u.onreadystatechange||p||(u.htmlFor=u.id="_reqwest_"+s),u.onload=u.onreadystatechange=function(){return u[readyState]&&"complete"!==u[readyState]&&"loaded"!==u[readyState]||c?!1:(u.onload=u.onreadystatechange=null,u.onclick&&u.onclick(),t(lastValue),lastValue=void 0,head.removeChild(u),void(c=1))},head.appendChild(u),{abort:function(){u.onload=u.onreadystatechange=null,r({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(u),c=1}}}function getRequest(e,t){var r,n=this.o,s=(n.method||"GET").toUpperCase(),i="string"==typeof n?n:n.url,o=n.processData!==!1&&n.data&&"string"!=typeof n.data?reqwest.toQueryString(n.data):n.data||null,a=!1;return"jsonp"!=n.type&&"GET"!=s||!o||(i=urlappend(i,o),o=null),"jsonp"==n.type?handleJsonp(n,e,t,i):(r=n.xhr&&n.xhr(n)||xhr(n),r.open(s,i,n.async===!1?!1:!0),setHeaders(r,n),setCredentials(r,n),win[xDomainRequest]&&r instanceof win[xDomainRequest]?(r.onload=e,r.onerror=t,r.onprogress=function(){},a=!0):r.onreadystatechange=handleReadyState(this,e,t),n.before&&n.before(r),a?setTimeout(function(){r.send(o)},200):r.send(o),r)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){return e.match("json")?"json":e.match("javascript")?"js":e.match("text")?"html":e.match("xml")?"xml":void 0}function init(o,fn){function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function error(e,t,r){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=r,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,r);complete(e)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var r,n,s,i,o=e.name,a=e.tagName.toLowerCase(),l=function(e){e&&!e.disabled&&t(o,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))};if(!e.disabled&&o)switch(a){case"input":/reset|button|image|file/i.test(e.type)||(r=/checkbox/i.test(e.type),n=/radio/i.test(e.type),s=e.value,(!(r||n)||e.checked)&&t(o,normalize(r&&""===s?"on":s)));break;case"textarea":t(o,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())l(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(i=0;e.length&&i<e.length;i++)e.options[i].selected&&l(e.options[i])}}function eachFormElement(){var e,t,r=this,n=function(e,t){var n,s,i;for(n=0;n<t.length;n++)for(i=e[byTag](t[n]),s=0;s<i.length;s++)serial(i[s],r)};for(t=0;t<arguments.length;t++)e=arguments[t],/input|select|textarea/i.test(e.tagName)&&serial(e,r),n(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,r){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(r)):e[t]=r},arguments),e}function buildParams(e,t,r,n){var s,i,o,a=/\[\]$/;if(isArray(t))for(i=0;t&&i<t.length;i++)o=t[i],r||a.test(e)?n(e,o):buildParams(e+"["+("object"==typeof o?i:"")+"]",o,r,n);else if(t&&"[object Object]"===t.toString())for(s in t)buildParams(e+"["+s+"]",t[s],r,n);else n(e,t)}var win=window,doc=document,httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(e.crossOrigin===!0){var t=win[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},"catch":function(e){return this.fail(e)}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,r){e.push({name:t,value:r})},arguments),e},reqwest.serialize=function(){if(0===arguments.length)return"";var e,t,r=Array.prototype.slice.call(arguments,0);return e=r.pop(),e&&e.nodeType&&r.push(e)&&(e=null),e&&(e=e.type),t="map"==e?serializeHash:"array"==e?reqwest.serializeArray:serializeQueryString,t.apply(null,r)},reqwest.toQueryString=function(e,t){var r,n,s=t||!1,i=[],o=encodeURIComponent,a=function(e,t){t="function"==typeof t?t():null==t?"":t,i[i.length]=o(e)+"="+o(t)};if(isArray(e))for(n=0;e&&n<e.length;n++)a(e[n].name,e[n].value);else for(r in e)e.hasOwnProperty(r)&&buildParams(r,e[r],s,a);return i.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest})},{}],8:[function(e){"use strict";var t=e("./bower_components/reqwest/reqwest.js"),r=e("./bower_components/dom-delegate/lib/delegate.js"),n=document.querySelector(".o-header"),s=document.querySelector(".o-header__secondary--myft-js"),i=n.getAttribute("data-default-panel"),o=new r(n),a=new r,l=e("./bower_components/next-user-preferences/src/main.js");o.on("click",".o-header-button-js",function(e){e.preventDefault(),e.stopPropagation();var t=e.target.getAttribute("data-target-panel")||e.target.parentNode.getAttribute("data-target-panel")||i,r=n.getAttribute("data-panel");r!==t&&t!==i?(a.root(document.body),n.setAttribute("data-panel",t)):(a.root(),i?n.setAttribute("data-panel",i):n.removeAttribute("data-panel"))}),o.on("click",function(e){e.stopPropagation()}),a.on("click",function(e){e.preventDefault(),e.stopPropagation(),i?n.setAttribute("data-panel",i):n.removeAttribute("data-panel")}),document.addEventListener("notifications:new",function(e){var t=0,r=e.detail,s=n.querySelector('.o-header-button-js[data-target-panel="myft"]');for(var i in r)r[i]&&(t+=r[i].length);t>0&&(s.getElementsByClassName("notify-badge").length?s.getElementsByClassName("notify-badge")[0].textContent=t:s.insertAdjacentHTML("beforeend",'<span class="notify-badge">'+t+"</span>"))}),t("http://next-companies-et-al.herokuapp.com/v1/ubernav.json",function(e){var t=e.data;n.querySelector(".o-header__secondary--menu-js").innerHTML='<ul class="uber-index">'+t.map(function(e){return'<li class="uber-index__title" data-o-grid-colspan="6 M6 L3 XL3"><a href="'+e.nextUrl+'">'+e.title+'</a><ul class="uber-index__children">'+e.navigationItems.map(function(e){return'<li class="uber-index__child"><a href="'+e.nextUrl+'">'+e.title+"</a></li>"}).join("")+"</ul></li>"}).join("")}),s&&l.init(s,{notify:!0})},{"./bower_components/dom-delegate/lib/delegate.js":1,"./bower_components/next-user-preferences/src/main.js":5,"./bower_components/reqwest/reqwest.js":7}]},{},[8]);